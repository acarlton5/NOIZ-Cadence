<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>NOIZ Avatar – Concept Wardrobe</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
<style>
  :root{
    --bg-1:#1c0f5b;
    --bg-2:#2a0d6f;
    --panel:#120a38;
    --accent:#7a5cff;
  }
  html,body{height:100%;}
  body{
    background: radial-gradient(1200px 700px at 75% 30%, var(--bg-2) 0%, var(--bg-1) 60%, #0b0730 100%);
    color:#e9e6ff;
    overflow:hidden;
  }
  .app{
    height:100vh;
    display:grid;
    grid-template-columns: 68px 1fr minmax(520px, 40%);
    gap:18px;
    padding:20px;
  }

  /* Sidebar */
  .slotbar{
    background:rgba(255,255,255,0.06);
    border-radius:16px;
    padding:10px 8px;
    display:flex; flex-direction:column; align-items:center; gap:8px;
  }
  .slotbtn{
    width:44px; height:44px;
    border-radius:12px;
    display:grid; place-items:center;
    color:#d6d2ff;
    background:transparent;
    border:none;
    transition:all .15s ease;
  }
  .slotbtn.active, .slotbtn:hover{
    background:rgba(122,92,255,.18);
    color:#fff;
  }
  .slotdivider{height:1px;width:70%;background:rgba(255,255,255,.12);margin:8px 0;}

  /* Catalog panel */
  .catalog{
    background:rgba(255,255,255,0.06);
    border-radius:16px;
    padding:18px;
    height:100%;
    overflow:auto;
  }
  .panel-title{font-weight:700; letter-spacing:.02em; margin-bottom:14px;}
  .searchrow{margin-bottom:14px;}

  /* Cards (white style for readability) */
  .card.item {
    background:#ffffff;
    color:#1c1447;
    border:none;
    border-radius:14px;
    transition:transform .12s ease, box-shadow .12s ease;
  }
  .card.item:hover{
    transform:translateY(-2px);
    box-shadow:0 10px 28px rgba(0,0,0,.25);
  }
  .card.item .slotlabel{
    font-size:.72rem; text-transform:uppercase; letter-spacing:.06em;
    opacity:.6; color:#5a548c;
  }
  .item .thumb{
    aspect-ratio:1/1;
    background:linear-gradient(145deg, #f4f2ff 0%, #e9e6ff 100%);
    display:grid; place-items:center;
    border-radius:12px; margin:10px;
    font-size:38px; color:var(--accent);
  }

  /* Preview panel */
  .preview{
    background:rgba(255,255,255,0.06);
    border-radius:16px;
    padding:18px;
    height:100%;
    display:flex; flex-direction:column;
  }
  .preview .stage{
    flex:1;
    background:var(--panel);
    border-radius:16px;
    overflow:hidden;
    box-shadow: inset 0 0 0 1px rgba(255,255,255,.06);
  }
  .toolbar{display:flex; gap:8px;}
  .btn-soft{
    --bs-btn-color:#e9e6ff;
    --bs-btn-bg:transparent;
    --bs-btn-border-color:rgba(255,255,255,.18);
    --bs-btn-hover-bg:rgba(255,255,255,.08);
    --bs-btn-hover-border-color:rgba(255,255,255,.28);
    --bs-btn-active-bg:rgba(255,255,255,.12);
    --bs-btn-active-border-color:rgba(255,255,255,.28);
  }
  .savebtn{ background:var(--accent); border:none;}
  .headrow{ align-items:center; margin-bottom:12px;}
  .muted{opacity:.72;}

  /* Search input styling */
  .input-group .form-control{
    background:rgba(255,255,255,.08);
    color:#e9e6ff;
    border:1px solid rgba(255,255,255,.18);
  }
  .input-group .form-control::placeholder{ color:#cfc9ff; opacity:.6; }
  .input-group .form-control:focus{
    background:rgba(255,255,255,.1);
    box-shadow:0 0 0 .2rem rgba(122,92,255,.25);
    border-color:rgba(122,92,255,.6);
  }
  .input-group-text{ color:#cfc9ff; background:transparent; border:1px solid rgba(255,255,255,.18);}
</style>
</head>
<body>
  <div class="app">
    <!-- Sidebar -->
    <aside class="slotbar">
      <button class="slotbtn active" data-slot="head_accessory"
        data-bs-toggle="tooltip" data-bs-placement="right" data-bs-title="Head Accessory">
        <i class="bi bi-headset"></i>
      </button>
      <button class="slotbtn" data-slot="glasses"
        data-bs-toggle="tooltip" data-bs-placement="right" data-bs-title="Glasses / Masks">
        <i class="bi bi-eyeglasses"></i>
      </button>
      <button class="slotbtn" data-slot="shirt"
        data-bs-toggle="tooltip" data-bs-placement="right" data-bs-title="Shirt">
        <i class="bi bi-tshirt"></i>
      </button>
      <button class="slotbtn" data-slot="jacket"
        data-bs-toggle="tooltip" data-bs-placement="right" data-bs-title="Jacket / Hoodie">
        <i class="bi bi-hoodie"></i>
      </button>
      <button class="slotbtn" data-slot="left_arm_accessory"
        data-bs-toggle="tooltip" data-bs-placement="right" data-bs-title="Left Arm Accessory">
        <i class="bi bi-smartwatch"></i>
      </button>
      <button class="slotbtn" data-slot="right_arm_accessory"
        data-bs-toggle="tooltip" data-bs-placement="right" data-bs-title="Right Arm Accessory">
        <i class="bi bi-hand-index-thumb"></i>
      </button>
      <button class="slotbtn" data-slot="back_accessory"
        data-bs-toggle="tooltip" data-bs-placement="right" data-bs-title="Back Accessory">
        <i class="bi bi-backpack2"></i>
      </button>
      <div class="slotdivider"></div>
      <button class="slotbtn" data-slot="pants"
        data-bs-toggle="tooltip" data-bs-placement="right" data-bs-title="Pants / Bottoms">
        <i class="bi bi-distribute-vertical"></i>
      </button>
      <button class="slotbtn" data-slot="shoes"
        data-bs-toggle="tooltip" data-bs-placement="right" data-bs-title="Shoes">
        <i class="bi bi-bootstrap-reboot"></i>
      </button>
      <div class="slotdivider"></div>
      <button class="slotbtn" data-slot="ground_prop"
        data-bs-toggle="tooltip" data-bs-placement="right" data-bs-title="Ground Prop">
        <i class="bi bi-record-circle"></i>
      </button>
      <button class="slotbtn" data-slot="accent_left"
        data-bs-toggle="tooltip" data-bs-placement="right" data-bs-title="Left Prop">
        <i class="bi bi-box-arrow-left"></i>
      </button>
      <button class="slotbtn" data-slot="accent_right"
        data-bs-toggle="tooltip" data-bs-placement="right" data-bs-title="Right Prop">
        <i class="bi bi-box-arrow-right"></i>
      </button>
      <button class="slotbtn" data-slot="orbiting_prop"
        data-bs-toggle="tooltip" data-bs-placement="right" data-bs-title="Orbiting Prop">
        <i class="bi bi-stars"></i>
      </button>
      <div class="slotdivider"></div>
      <button class="slotbtn" data-slot="emote"
        data-bs-toggle="tooltip" data-bs-placement="right" data-bs-title="Emote">
        <i class="bi bi-person-walking"></i>
      </button>
      <button class="slotbtn" data-slot="vfx"
        data-bs-toggle="tooltip" data-bs-placement="right" data-bs-title="VFX / Aura">
        <i class="bi bi-brightness-alt-high"></i>
      </button>
    </aside>

    <!-- Catalog -->
    <main class="catalog">
      <div class="d-flex justify-content-between headrow">
        <div>
          <div class="panel-title">OUTFIT</div>
          <div class="small muted" id="slotLabel">Head Accessory</div>
        </div>
        <div class="toolbar">
          <button class="btn btn-sm btn-soft" id="btnDiscard">Discard</button>
          <button class="btn btn-sm savebtn" id="btnSave" disabled>Save</button>
        </div>
      </div>

      <!-- Search -->
      <div class="row align-items-center g-2 searchrow">
        <div class="col-12 col-md-6">
          <div class="input-group input-group-sm">
            <span class="input-group-text"><i class="bi bi-search"></i></span>
            <input id="searchInput" type="search" class="form-control"
              placeholder="Search items…" autocomplete="off">
          </div>
        </div>
      </div>

      <div class="row row-cols-2 row-cols-sm-3 row-cols-lg-4 g-3" id="grid"></div>
    </main>

    <!-- Preview -->
    <section class="preview">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <div>
          <div class="panel-title mb-0">Preview</div>
          <div class="small muted">Concept preview. Visuals only.</div>
        </div>
      </div>
      <div class="stage">
        <iframe id="avatarFrame" src="https://cdpn.io/cpe/boomboom/index.html?key=index.html-a5e20254-128a-349a-cd1e-722312da145c" style="border:0;width:100%;height:100%;"></iframe>
      </div>
    </section>
  </div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // Tooltips
  [...document.querySelectorAll('[data-bs-toggle="tooltip"]')]
    .forEach(el => new bootstrap.Tooltip(el));

  const CATALOG = [
    {id:'halo01',        name:'Halo',             slot:'head_accessory', icon:'<i class="bi bi-circle"></i>'},
    {id:'horns01',       name:'Horns',            slot:'head_accessory', icon:'<i class="bi bi-activity"></i>'},
    {id:'mask_psycho',   name:'Psycho Mask',      slot:'glasses',        icon:'<i class="bi bi-mask"></i>'},
    {id:'visor01',       name:'Visor',            slot:'glasses',        icon:'<i class="bi bi-eyeglasses"></i>'},
    {id:'tee_white',     name:'Tee – White',      slot:'shirt',          icon:'<i class="bi bi-tshirt"></i>'},
    {id:'hoodie_purp',   name:'Hoodie – Purple',  slot:'jacket',         icon:'<i class="bi bi-hoodie"></i>'},
    {id:'bracelet_l',    name:'Bracelet – L',     slot:'left_arm_accessory', icon:'<i class="bi bi-circle-half"></i>'},
    {id:'watch_r',       name:'Watch – R',        slot:'right_arm_accessory',icon:'<i class="bi bi-smartwatch"></i>'},
    {id:'wings01',       name:'Wings',            slot:'back_accessory', icon:'<i class="bi bi-feather"></i>'},
    {id:'jeans01',       name:'Jeans',            slot:'pants',          icon:'<i class="bi bi-distribute-vertical"></i>'},
    {id:'sneakers01',    name:'Sneakers',         slot:'shoes',          icon:'<i class="bi bi-bootstrap-reboot"></i>'},
    {id:'circle_demon',  name:'Demon Circle',     slot:'ground_prop',    icon:'<i class="bi bi-record-circle"></i>'},
    {id:'dbd_hook',      name:'DbD Hook',         slot:'accent_left',    icon:'<i class="bi bi-pin-angle"></i>'},
    {id:'pet_dragon',    name:'Pet Dragon',       slot:'orbiting_prop',  icon:'<i class="bi bi-stars"></i>'},
    {id:'pose_wave',     name:'Emote: Wave',      slot:'emote',          icon:'<i class="bi bi-person-walking"></i>'},
    {id:'aura_neon',     name:'VFX: Neon Aura',   slot:'vfx',            icon:'<i class="bi bi-brightness-alt-high"></i>'},
  ];

  const SLOT_LABELS = {
    head_accessory:'Head Accessory', glasses:'Glasses / Mask', shirt:'Shirt', jacket:'Jacket',
    left_arm_accessory:'Left Arm Accessory', right_arm_accessory:'Right Arm Accessory',
    back_accessory:'Back Accessory', pants:'Pants', shoes:'Shoes',
    ground_prop:'Ground Prop', accent_left:'Left Prop', accent_right:'Right Prop',
    orbiting_prop:'Orbiting Prop', emote:'Emote', vfx:'VFX / Aura'
  };

  const grid = document.getElementById('grid');
  const frame = () => document.getElementById('avatarFrame').contentWindow;
  let currentSlot = 'head_accessory';
  let searchQuery = '';

  function renderGrid(){
    const q = searchQuery.trim().toLowerCase();
    const items = CATALOG.filter(i =>
      i.slot === currentSlot &&
      (q === '' || i.name.toLowerCase().includes(q))
    );

    if(items.length === 0){
      grid.innerHTML = `
        <div class="col-12">
          <div class="p-4 text-center text-muted" style="background:rgba(255,255,255,.06); border-radius:12px;">
            No items match “${searchQuery}”.
          </div>
        </div>`;
      return;
    }

    grid.innerHTML = items.map(i => `
      <div class="col">
        <div class="card item h-100" data-id="${i.id}" data-slot="${i.slot}">
          <div class="thumb">${i.icon}</div>
          <div class="card-body pt-0">
            <div class="slotlabel">${SLOT_LABELS[i.slot]}</div>
            <div class="fw-semibold">${i.name}</div>
          </div>
        </div>
      </div>
    `).join('');
  }

  function debounce(fn, ms=150){
    let t; return (...args)=>{ clearTimeout(t); t=setTimeout(()=>fn(...args), ms); };
  }

  document.getElementById('searchInput').addEventListener('input', debounce((e)=>{
    searchQuery = e.target.value || '';
    renderGrid();
  }, 120));

  document.querySelectorAll('.slotbtn').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      document.querySelectorAll('.slotbtn').forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');
      currentSlot = btn.dataset.slot;
      document.getElementById('slotLabel').textContent = SLOT_LABELS[currentSlot] || 'Items';
      renderGrid();
    });
  });

  grid.addEventListener('click', (e)=>{
    const card = e.target.closest('.card.item'); if(!card) return;
    const id   = card.dataset.id;
    const slot = card.dataset.slot;
    frame().postMessage({type:'equip', payload:{id, slot}}, '*');
    document.getElementById('btnSave').disabled = false;
  });

  document.getElementById('btnDiscard').addEventListener('click', ()=>{
    frame().postMessage({type:'reset'}, '*');
    document.getElementById('btnSave').disabled = true;
  });

  document.getElementById('btnSave').addEventListener('click', ()=>{
    frame().postMessage({type:'save'}, '*');
  });

  renderGrid();
</script>
</body>
</html>
